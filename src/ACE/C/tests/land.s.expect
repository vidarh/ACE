
	xref _AbsExecBase
	xref _LVOPermit
	xref _MathBase
	xref _LVOSPAdd
	xref _LVOSPFlt
	xref _LVOSPDiv
	xref _rnd
	xref _modffp
	xref _LVOSPSub
	xref _LVOSPCmp
	xref _round
	xref lmulu
	xref _LVOForbid
	xref _SUB_RNDCHOICE@
	xref ace_ldiv
	xref _SUB_FULL
	xref _LVOSPMul
	xref _GfxBase
	xref _RPort
	xref _LVOMove
	xref _LVOWritePixel
	xref _LVODraw
	xref _SUB_UNIVERSAL_X@
	xref _SUB_UNIVERSAL_Y@
	xref _setxy
	xref _mouse
	xref _SUB_DRAW_UNIVERSAL_LINE
	xref _SUB_SLANT
	xref _SUB_ALONG
	xref _SUB_FILL
	xref _SUB_DRAW
	xref _SUB_INITIALISE
	xref _openscreen
	xref _palette
	xref _LVOSetAPen
	xref _fgdpen
	xref _bgpen
	xref _changetextcolor
	xref _penup
	xref _timer
	xref _randomise
	xref _SUB_COMPUTE_AND_DISPLAY
	xref _locate
	xref _stringprints
	xref _printsLF
	xref _inkey
	xref _streq
	xref _sleep
	xref _closescreen
	xref _startup
	xref _cleanup
	xref _openmathffp
	xref _closemathffp
	xref _IntuitionBase
	xref _DosBase
	xref _opengfx
	xref _closegfx
	xref _openintuition
	xref _closeintuition
	xref _starterr
	xdef _EXIT_PROG
	xref _free_alloc

	SECTION code,CODE

	jsr	_startup
	cmpi.b	#1,_starterr
	bne.s	_START_PROG
	rts
_START_PROG:
	move.l	sp,_initialSP
	movem.l	d1-d7/a0-a6,-(sp)
	jsr	_openmathffp
	cmpi.b	#1,_starterr
	bne.s	_mathffp_ok
	jmp	_ABORT_PROG
_mathffp_ok:
	jsr	_openintuition
	cmpi.b	#1,_starterr
	bne.s	_intuition_ok
	jmp	_ABORT_PROG
_intuition_ok:
	jsr	_opengfx
	cmpi.b	#1,_starterr
	bne.s	_gfx_ok
	jmp	_ABORT_PROG
_gfx_ok:
	link	a4,#-88

	move.l	#0,-4(a4)
	move.l	#0,-8(a4)
	move.l	#0,-12(a4)
	move.l	#0,-16(a4)
	move.l	#0,-20(a4)
	move.l	#0,-24(a4)
	move.l	#0,-28(a4)
	move.l	#0,-32(a4)
	move.l	#0,-36(a4)
	pea	_array0
	move.l	(sp)+,-40(a4)
	jmp	_lab0
_SUB_RNDCHOICE@:
	link	a5,#-28
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	a4,d0
	sub.l	#8,d0
	move.l	d0,-12(a5)
	move.l	a4,d0
	sub.l	#4,d0
	move.l	d0,-16(a5)
	move.l	a4,d0
	sub.l	#12,d0
	move.l	d0,-20(a5)
	move.l	a4,d0
	sub.l	#16,d0
	move.l	d0,-24(a5)
	move.l	-4(a5),-(sp)
	move.l	-8(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.w	#2,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	jsr	_rnd
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	jsr	_modffp
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.l	-16(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-28(a5)
	move.l	-28(a5),-(sp)
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	moveq	#-1,d5
	move.l	_MathBase,a6
	jsr	_LVOSPCmp(a6)
	blt.s	_lab1
	moveq	#0,d5
_lab1:
	move.l	d5,-(sp)
	move.l	(sp)+,d0
	cmpi.l	#0,d0
	bne.s	_lab2
	jmp	_lab3
_lab2:
	move.l	-28(a5),-(sp)
	move.l	-20(a5),a0
	move.l	(sp)+,(a0)
_lab3:
	move.l	-28(a5),-(sp)
	move.l	-24(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	moveq	#-1,d5
	move.l	_MathBase,a6
	jsr	_LVOSPCmp(a6)
	bgt.s	_lab4
	moveq	#0,d5
_lab4:
	move.l	d5,-(sp)
	move.l	(sp)+,d0
	cmpi.l	#0,d0
	bne.s	_lab5
	jmp	_lab6
_lab5:
	move.l	-28(a5),-(sp)
	move.l	-24(a5),a0
	move.l	(sp)+,(a0)
_lab6:
	move.l	-28(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,-44(a4)
_EXIT_SUB_RNDCHOICE@:
	unlk	a5
	rts	  
_lab0:
	jmp	_lab7
_SUB_FULL:
	link	a5,#-56
	move.l	a4,d0
	sub.l	#4,d0
	move.l	d0,-4(a5)
	move.l	a4,d0
	sub.l	#8,d0
	move.l	d0,-8(a5)
	move.l	-40(a4),-12(a5)
	move.l	#0,-16(a5)
	move.l	#0,-20(a5)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-20(a5)
_lab8:
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,-16(a5)
_lab9:
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-16(a5),-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-12(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-24(a5)
	move.l	-16(a5),-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	add.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-28(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-12(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-32(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-24(a5),-12(sp)
	move.l	-32(a5),-16(sp)
	jsr	_SUB_RNDCHOICE@
	move.l	-44(a4),-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-16(a5),-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-12(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-36(a5)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-16(a5),-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	add.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-12(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-40(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-36(a5),-12(sp)
	move.l	-40(a5),-16(sp)
	jsr	_SUB_RNDCHOICE@
	move.l	-44(a4),-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.l	-16(a5),-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	add.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-12(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-44(a5)
	move.l	-16(a5),-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	add.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-12(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-48(a5)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-44(a5),-(sp)
	move.l	(sp)+,-52(a5)
	move.l	-48(a5),-(sp)
	move.l	(sp)+,-56(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-52(a5),-12(sp)
	move.l	-56(a5),-16(sp)
	jsr	_SUB_RNDCHOICE@
	move.l	-44(a4),-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.l	-16(a5),-(sp)
	move.l	-8(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	add.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,-16(a5)
	move.l	-16(a5),-(sp)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	-20(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	sub.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	moveq	#-1,d5
	cmp.l	d1,d0
	bgt.s	_lab10
	moveq	#0,d5
_lab10:
	move.l	d5,-(sp)
	move.l	(sp)+,d0
	cmpi.l	#0,d0
	bne.s	_lab11
	jmp	_lab9
_lab11:
	move.l	-20(a5),-(sp)
	move.l	-8(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	add.l	d1,d0
	move.l	d0,-(sp)
	move.l	(sp)+,-20(a5)
	move.l	-20(a5),-(sp)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	moveq	#-1,d5
	cmp.l	d1,d0
	bge.s	_lab12
	moveq	#0,d5
_lab12:
	move.l	d5,-(sp)
	move.l	(sp)+,d0
	cmpi.l	#0,d0
	bne.s	_lab13
	jmp	_lab8
_lab13:
_EXIT_SUB_FULL:
	unlk	a5
	rts	  
_lab7:
	jmp	_lab14
_SUB_FILL:
	link	a5,#-28
	move.l	a4,d0
	sub.l	#12,d0
	move.l	d0,-4(a5)
	move.l	a4,d0
	sub.l	#16,d0
	move.l	d0,-8(a5)
	move.l	-40(a4),-12(a5)
	move.l	a4,d0
	sub.l	#8,d0
	move.l	d0,-16(a5)
	move.l	a4,d0
	sub.l	#4,d0
	move.l	d0,-20(a5)
	move.l	#0,-24(a5)
	move.l	#0,-28(a5)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-24(a5)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	#1,-(sp)
_lab15:
	move.l	-24(a5),d0
	move.l	4(sp),d1
	cmpi.l	#0,(sp)
	blt.s	_lab16
	cmp.l	d1,d0
	bgt	_lab22
	jmp	_lab17
_lab16:
	cmp.l	d1,d0
	blt	_lab22
_lab17:
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-28(a5)
	move.w	#36,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	#1,-(sp)
_lab18:
	move.l	-28(a5),d0
	move.l	4(sp),d1
	cmpi.l	#0,(sp)
	blt.s	_lab19
	cmp.l	d1,d0
	bgt	_lab21
	jmp	_lab20
_lab19:
	cmp.l	d1,d0
	blt	_lab21
_lab20:
	move.l	-24(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-28(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.l	(sp),d0
	add.l	d0,-28(a5)
	jmp	_lab18
_lab21:
	add.l	#8,sp
	move.l	(sp),d0
	add.l	d0,-24(a5)
	jmp	_lab15
_lab22:
	add.l	#8,sp
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-4(a5),a0
	move.l	(sp)+,(a0)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-8(a5),a0
	move.l	(sp)+,(a0)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	-16(a5),a0
	move.l	(sp)+,(a0)
	move.l	-16(a5),a0
	move.l	(a0),-(sp)
	move.w	#2,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	jsr	ace_ldiv
	add.l	#8,sp
	move.l	d0,-(sp)
	move.l	-20(a5),a0
	move.l	(sp)+,(a0)
_lab23:
	jsr	_SUB_FULL
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.l	-16(a5),a0
	move.l	(sp)+,(a0)
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.w	#2,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	jsr	ace_ldiv
	add.l	#8,sp
	move.l	d0,-(sp)
	move.l	-20(a5),a0
	move.l	(sp)+,(a0)
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.l	-16(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	moveq	#-1,d5
	cmp.l	d1,d0
	beq.s	_lab24
	moveq	#0,d5
_lab24:
	move.l	d5,-(sp)
	move.l	(sp)+,d0
	cmpi.l	#0,d0
	bne.s	_lab25
	jmp	_lab23
_lab25:
	move.w	#0,-(sp)
	move.w	#34,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	add.w	d1,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-4(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.w	#1,-(sp)
	move.w	#34,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	add.w	d1,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-8(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.w	#2,-(sp)
	move.w	#34,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	add.w	d1,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-16(a5),a0
	move.l	(a0),-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
	move.w	#3,-(sp)
	move.w	#34,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	add.w	d1,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	d7,_tmpelement
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.l	_tmpelement,d7
	move.l	-12(a5),a0
	move.l	(sp)+,0(a0,d7.L)
_EXIT_SUB_FILL:
	unlk	a5
	rts	  
_lab14:
	jmp	_lab26
_SUB_SET_UNIVERSAL_POINT:
	link	a5,#-32
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	a4,d0
	sub.l	#24,d0
	move.l	d0,-12(a5)
	move.l	a4,d0
	sub.l	#28,d0
	move.l	d0,-16(a5)
	move.l	a4,d0
	sub.l	#32,d0
	move.l	d0,-20(a5)
	move.l	a4,d0
	sub.l	#36,d0
	move.l	d0,-24(a5)
	move.l	-4(a5),-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.w	#640,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	-16(a5),a0
	move.l	(a0),-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-28(a5)
	move.l	-8(a5),-(sp)
	move.l	-24(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.w	#200,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.l	-24(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-32(a5)
	move.l	-28(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-32(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	move.l	_GfxBase,a6
	move.l	_RPort,a1
	move.l	a1,a3
	move.w	d0,d3
	move.w	d1,d4
	jsr	_LVOMove(a6)
	move.w	d4,d1
	move.w	d3,d0
	move.l	a3,a1
	jsr	_LVOWritePixel(a6)
_EXIT_SUB_SET_UNIVERSAL_POINT:
	unlk	a5
	rts	  
_lab26:
	jmp	_lab27
_SUB_DRAW_UNIVERSAL_LINE:
	link	a5,#-32
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	a4,d0
	sub.l	#24,d0
	move.l	d0,-12(a5)
	move.l	a4,d0
	sub.l	#28,d0
	move.l	d0,-16(a5)
	move.l	a4,d0
	sub.l	#32,d0
	move.l	d0,-20(a5)
	move.l	a4,d0
	sub.l	#36,d0
	move.l	d0,-24(a5)
	move.l	-4(a5),-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.w	#640,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	-16(a5),a0
	move.l	(a0),-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-28(a5)
	move.l	-8(a5),-(sp)
	move.l	-24(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.w	#200,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	-20(a5),a0
	move.l	(a0),-(sp)
	move.l	-24(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-32(a5)
	move.l	-28(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-32(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	move.w	d0,_xmin
	move.w	d1,_ymin
	move.l	_RPort,a1
	move.l	_GfxBase,a6
	jsr	_LVODraw(a6)
_EXIT_SUB_DRAW_UNIVERSAL_LINE:
	unlk	a5
	rts	  
_lab27:
	jmp	_lab28
_SUB_UNIVERSAL_X@:
	link	a5,#-12
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	a4,d0
	sub.l	#24,d0
	move.l	d0,-8(a5)
	move.l	a4,d0
	sub.l	#28,d0
	move.l	d0,-12(a5)
	move.l	-4(a5),-(sp)
	move.l	-8(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.w	#640,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	-8(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,-64(a4)
_EXIT_SUB_UNIVERSAL_X@:
	unlk	a5
	rts	  
_lab28:
	jmp	_lab29
_SUB_UNIVERSAL_Y@:
	link	a5,#-12
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	a4,d0
	sub.l	#32,d0
	move.l	d0,-8(a5)
	move.l	a4,d0
	sub.l	#36,d0
	move.l	d0,-12(a5)
	move.l	-4(a5),-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.w	#200,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	-8(a5),a0
	move.l	(a0),-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPDiv(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,-68(a4)
_EXIT_SUB_UNIVERSAL_Y@:
	unlk	a5
	rts	  
_lab29:
	jmp	_lab30
_SUB_SLANT:
	link	a5,#-32
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	-40(a4),-8(a5)
	move.l	a4,d0
	sub.l	#20,d0
	move.l	d0,-12(a5)
	move.l	#0,-16(a5)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,-20(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-20(a5),-12(sp)
	jsr	_SUB_UNIVERSAL_X@
	move.l	-64(a4),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.w	#0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-8(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-24(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-24(a5),-12(sp)
	jsr	_SUB_UNIVERSAL_Y@
	move.l	-68(a4),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	jsr	_setxy
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-16(a5)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	#1,-(sp)
_lab31:
	move.l	-16(a5),d0
	move.l	4(sp),d1
	cmpi.l	#0,(sp)
	blt.s	_lab32
	cmp.l	d1,d0
	bgt	_lab36
	jmp	_lab33
_lab32:
	cmp.l	d1,d0
	blt	_lab36
_lab33:
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab34
	jsr	FINISH
_lab34:
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-28(a5)
	move.l	-4(a5),-(sp)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-8(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-32(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-28(a5),-12(sp)
	move.l	-32(a5),-16(sp)
	jsr	_SUB_DRAW_UNIVERSAL_LINE
	move.l	(sp),d0
	add.l	d0,-16(a5)
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab35
	jsr	FINISH
_lab35:
	jmp	_lab31
_lab36:
	add.l	#8,sp
_EXIT_SUB_SLANT:
	unlk	a5
	rts	  
_lab30:
	jmp	_lab37
_SUB_ALONG:
	link	a5,#-32
	move.l	_AbsExecBase,a6
	jsr	_LVOPermit(a6)
	move.l	-40(a4),-8(a5)
	move.l	a4,d0
	sub.l	#20,d0
	move.l	d0,-12(a5)
	move.l	#0,-16(a5)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,-20(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-20(a5),-12(sp)
	jsr	_SUB_UNIVERSAL_X@
	move.l	-64(a4),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	#0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-8(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-24(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-24(a5),-12(sp)
	jsr	_SUB_UNIVERSAL_Y@
	move.l	-68(a4),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	jsr	_setxy
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-16(a5)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPSub(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	#1,-(sp)
_lab38:
	move.l	-16(a5),d0
	move.l	4(sp),d1
	cmpi.l	#0,(sp)
	blt.s	_lab39
	cmp.l	d1,d0
	bgt	_lab43
	jmp	_lab40
_lab39:
	cmp.l	d1,d0
	blt	_lab43
_lab40:
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab41
	jsr	FINISH
_lab41:
	move.l	-4(a5),-(sp)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-28(a5)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-4(a5),-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.w	d0,-(sp)
	moveq	#0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#1,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	move.w	(sp)+,d1
	ext.l	d1
	move.l	d1,-(sp)
	move.l	#37,-(sp)
	jsr	lmulu
	add.l	#8,sp
	add.l	d0,d7
	lsl.l	#2,d7
	move.l	-8(a5),a0
	move.l	0(a0,d7.L),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(a0),-(sp)
	move.l	(sp)+,d0
	move.l	(sp)+,d1
	move.l	_MathBase,a6
	jsr	_LVOSPMul(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d1
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPAdd(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-32(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-28(a5),-12(sp)
	move.l	-32(a5),-16(sp)
	jsr	_SUB_DRAW_UNIVERSAL_LINE
	move.l	(sp),d0
	add.l	d0,-16(a5)
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab42
	jsr	FINISH
_lab42:
	jmp	_lab38
_lab43:
	add.l	#8,sp
_EXIT_SUB_ALONG:
	unlk	a5
	rts	  
_lab37:
	jmp	_lab44
_SUB_DRAW:
	link	a5,#-24
	move.l	a4,d0
	sub.l	#20,d0
	move.l	d0,-4(a5)
	move.l	-40(a4),-8(a5)
	move.l	#0,-12(a5)
	move.l	#0,-16(a5)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-16(a5)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	#1,-(sp)
_lab45:
	move.l	-16(a5),d0
	move.l	4(sp),d1
	cmpi.l	#0,(sp)
	blt.s	_lab46
	cmp.l	d1,d0
	bgt	_lab50
	jmp	_lab47
_lab46:
	cmp.l	d1,d0
	blt	_lab50
_lab47:
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab48
	jsr	FINISH
_lab48:
	move.l	-16(a5),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-20(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-20(a5),-12(sp)
	jsr	_SUB_SLANT
	move.l	(sp),d0
	add.l	d0,-16(a5)
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab49
	jsr	FINISH
_lab49:
	jmp	_lab45
_lab50:
	add.l	#8,sp
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	(sp)+,-12(a5)
	move.w	#34,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	d0,-(sp)
	move.l	#1,-(sp)
_lab51:
	move.l	-12(a5),d0
	move.l	4(sp),d1
	cmpi.l	#0,(sp)
	blt.s	_lab52
	cmp.l	d1,d0
	bgt	_lab56
	jmp	_lab53
_lab52:
	cmp.l	d1,d0
	blt	_lab56
_lab53:
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab54
	jsr	FINISH
_lab54:
	move.l	-12(a5),-(sp)
	move.l	(sp)+,d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,-24(a5)
	move.l	_AbsExecBase,a6
	jsr	_LVOForbid(a6)
	move.l	-24(a5),-12(sp)
	jsr	_SUB_ALONG
	move.l	(sp),d0
	add.l	d0,-12(a5)
	moveq	#0,d0
	jsr	_mouse
	cmpi.l	#0,d0
	beq.s	_lab55
	jsr	FINISH
_lab55:
	jmp	_lab51
_lab56:
	add.l	#8,sp
_EXIT_SUB_DRAW:
	unlk	a5
	rts	  
_lab44:
	jmp	_lab57
_SUB_INITIALISE:
	link	a5,#-20
	move.l	a4,d0
	sub.l	#24,d0
	move.l	d0,-4(a5)
	move.l	a4,d0
	sub.l	#28,d0
	move.l	d0,-8(a5)
	move.l	a4,d0
	sub.l	#32,d0
	move.l	d0,-12(a5)
	move.l	a4,d0
	sub.l	#36,d0
	move.l	d0,-16(a5)
	move.l	a4,d0
	sub.l	#20,d0
	move.l	d0,-20(a5)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-4(a5),a0
	move.l	(sp)+,(a0)
	move.w	#20,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-8(a5),a0
	move.l	(sp)+,(a0)
	move.w	#10,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-16(a5),a0
	move.l	(sp)+,(a0)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	-12(a5),a0
	move.l	(sp)+,(a0)
	move.l	#$6,-(sp)
	move.l	-20(a5),a0
	move.l	(sp)+,(a0)
_EXIT_SUB_INITIALISE:
	unlk	a5
	rts	  
_lab57:
	jmp	_lab58
_SUB_COMPUTE_AND_DISPLAY:
	link	a5,#0
	jsr	_SUB_FILL
	jsr	_SUB_DRAW
_EXIT_SUB_COMPUTE_AND_DISPLAY:
	unlk	a5
	rts	  
_lab58:
	jsr	_SUB_INITIALISE
	move.w	#1,-(sp)
	move.w	#640,-(sp)
	move.w	#200,-(sp)
	move.w	#2,-(sp)
	move.w	#2,-(sp)
	move.w	(sp)+,d4
	move.w	(sp)+,d3
	move.w	(sp)+,d2
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	jsr	_openscreen
	move.w	#0,-(sp)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.w	#0,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d3
	move.l	(sp)+,d2
	move.l	(sp)+,d1
	move.w	(sp)+,d0
	jsr	_palette
	move.w	#1,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.w	#1,-(sp)
	move.w	(sp)+,d0
	ext.l	d0
	move.l	_MathBase,a6
	jsr	_LVOSPFlt(a6)
	move.l	d0,-(sp)
	move.l	(sp)+,d3
	move.l	(sp)+,d2
	move.l	(sp)+,d1
	move.w	(sp)+,d0
	jsr	_palette
	move.w	#1,-(sp)
	move.w	(sp)+,d0
	move.w	d0,_fg
	move.w	d0,_fgdpen
	move.l	_RPort,a1
	move.l	_GfxBase,a6
	jsr	_LVOSetAPen(a6)
	move.w	_bgpen,_bg
	move.w	_fg,d0
	move.w	_bg,d0
	jsr	_changetextcolor
	jsr	_penup
	jsr	_timer
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	jsr	_round
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	jsr	_randomise
	jsr	_SUB_COMPUTE_AND_DISPLAY
FINISH:
	move.w	#3,-(sp)
	move.w	#5,-(sp)
	move.w	(sp)+,d1
	move.w	(sp)+,d0
	jsr	_locate
	pea	_stringconst0
	move.l	(sp)+,a0
	jsr	_stringprints
	jsr	_printsLF
_lab59:
	jsr	_inkey
	move.l	d0,-(sp)
	pea	_stringconst1
	move.l	(sp)+,a1
	move.l	(sp)+,a0
	jsr	_streq
	move.l	d0,-(sp)
	move.l	(sp)+,d0
	cmpi.l	#0,d0
	bne.s	_lab60
	jmp	_lab61
_lab60:
	jsr	_sleep
	jmp	_lab59
_lab61:
	move.w	#1,-(sp)
	move.w	(sp)+,d0
	jsr	_closescreen
	jmp	_EXIT_PROG

_EXIT_PROG:
	unlk	a4
_ABORT_PROG:
	jsr	_free_alloc
	jsr	_closegfx
	jsr	_closeintuition
	jsr	_closemathffp
	movem.l	(sp)+,d1-d7/a0-a6
	move.l	_initialSP,sp
	jsr	_cleanup

	rts

	SECTION data,DATA

_stringconst0:	dc.b "hit a key...",0
_stringconst1:	dc.b "",0

	SECTION mem,BSS

_array0:	ds.l 1295
_tmpelement	ds.l 1
_xmin	ds.w 1
_ymin	ds.w 1
_fg	ds.w 1
_bg	ds.w 1
_initialSP:	ds.l 1

	END
